# analytics/vulnerability.py
class Vulnerability:
    """
    Representa uma vulnerabilidade de segurança encontrada no código.
    """
    def __init__(self, vul_type: str, description: str, severity: str,
                 line: int, code_snippet: str, suggestion: str):
        self.type = vul_type
        self.description = description
        self.severity = severity
        self.line = line
        self.code_snippet = code_snippet
        self.suggestion = suggestion

    def __str__(self):
        return (f"Tipo: {self.type}\n"
                f"Descrição: {self.description}\n"
                f"Severidade: {self.severity}\n"
                f"Linha: {self.line}\n"
                f"Trecho de Código: '{self.code_snippet}'\n"
                f"Sugestão: {self.suggestion}")

    def to_dict(self):
        """Converte a instância da vulnerabilidade em um dicionário."""
        return {
            "type": self.type,
            "description": self.description,
            "severity": self.severity,
            "line": self.line,
            "code_snippet": self.code_snippet,
            "suggestion": self.suggestion
        }